使用spring-cloud-stream模块，中间件使用rabbit，实现跨服务队列服务。

```java
public  interface  EspSource {
  String  OUTPUT = "espOutput";

  /**
  * 消息输出通道
  *
  * @return 消息输出通道
  */
  @Output(OUTPUT)
  MessageChannel  output();
}

public  interface  EspSink {
  String  INPUT = "espInput";
  /**
  * 消息输入通道
  *
  * @return 消息输入通道
  */
  @Input(INPUT)
  SubscribableChannel  input();
}
```

建立输入、输出通道，如上代码所示。

```java
public  class  EspClientStreamEnvironmentPostProcessor  implements  EnvironmentPostProcessor {
  @Override
  public  void  postProcessEnvironment(ConfigurableEnvironment  environment, SpringApplication  application) {
    Map defaults = new  HashMap<>(2);
    defaults.put("spring.cloud.stream.bindings." + EspSource.OUTPUT + ".content-type",MediaType.APPLICATION\_JSON\_VALUE);
    defaults.put("spring.cloud.stream.bindings." + EspSource.OUTPUT + ".destination", "espTopic");
    EnvironmentUtils.addOrReplace(environment, defaults, "springCloudStreamCustomProperties");
  }
}
```
定义rabbit变量，配置输出、输入信息

```java
espSource.output().send(MessageBuilder.withPayload(jsonMap).build());
```
发送信息如上代码所示。
```java
@StreamListener(EspSink.INPUT)
public  void  receiveMessage(Message> message) {

}
```
接受信息处理。